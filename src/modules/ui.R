library(shiny)
library(scales)
library(bslib)
library(DT)
library(shinyMatrix)

ui <- navbarPage(
  
  title = "MASLD Treatment Activity and Costs Modelling",
  id = "navbar",
  
  tags$link(rel = "stylesheet", type = "text/css", href = "config/app_theme.css"),

  tabPanel("Introduction",
           fluidPage(
             h1("Introduction to the MASLD Treatment Activity and Costs Model"),
             p("This model has been developed to simulate the populations, clinical activities and associated costs 
               of implementing four new treatment pathways for ", strong("Metabolic Dysfunction-Associated Steatotic Liver Disease (MASLD).")),
             p("These four new treatment pathways include the use of the following treatments:",
               tags$ul(
                 tags$li("Semaglutide"),
                 tags$li("Servodutide"),
                 tags$li("Resmetiron"),
                 tags$li("Lanifibranor")
               )),
             p("The three tabs below provide guidance and information on:",
               tags$ul(
                 tags$li("Using the model"),
                 tags$li("Understanding the assumptions in the model and how these are applied"),
                 tags$li("Links to more detailed documentation regarding the development of the model")
               )),
             navset_tab(
               nav_panel("How to use the model",
                         h2("How to use the model"),
                         p("This section provides an overview of how to use the model and covers:",
                           tags$ul(
                             tags$li("The structure of the model"),
                             tags$li("Navigating between sections"),
                             tags$li("Changing different input assumptions"),
                             tags$li("Reviewing the model outputs"),
                             tags$li("Extracting model outputs and assumptions")
                           )),
                         br(),
                         h3("Model Structure"),
                         p("This model has been created using the open source programming language ",
                           tags$a("R", href = "https://www.r-project.org/", target = "_blank"), "to create a shinyApp. 
                           The model contains a series of input tabs relating to different components of the model. These 
                           different input components include:",
                           tags$ul(
                             tags$li(strong("Population Assumptions:"), "These assumptions are used to determine the size of 
                                     population of patients that are potentially eligible for treatment. Therefore, this includes 
                                     assumptions such as the prevalence of MASLD, the breakdown of Fibrosis Stage and rates of 
                                     diagnosis for each Fibrosis Stage. The assumptions applied in this section will output an 
                                     estimate of the diagnosed population of patients at each Fibrosis Stage. These estimates are 
                                     then taken forward into the next section."),
                             tags$li(strong("Treatment Implementation:"), "These assumptions take the estimates of each diagnosed 
                                     Fibrosis Stage to model the percentage of patients being treated. There are separate assumptions 
                                     for each of the four treatments. The output of this section will be the number of patients 
                                     starting each treatment."),
                             tags$li(strong("Semaglutide Pathway Activity Assumptions:"), "The assumptions within this section relate 
                                     to how the new treatment pathway for Semaglutide is expected to be delivered. These assumptions 
                                     cover areas such as retention rates, the number of monitoring tests and the proportion of these 
                                     tests including specific diagnostics such as Fibroscanning or Liver biopsies. These assumptions 
                                     are applied to the estimated number of patients starting the Semaglutide treatment pathway to 
                                     determine the number of each clinical activity along this pathway."),
                             tags$li(strong("Survodutide Pathway Activity Assumptions:"), "Similarly to the Semaglutide pathway above, 
                                     this section contains the assumptions for the Survodutide pathway."),
                             tags$li(strong("Resmetiron Pathway Activity Assumptions:"), "Similarly to the Semaglutide pathway above, 
                                     this section contains the assumptions for the Resmetiron pathway."),
                             tags$li(strong("Lanifibranor Pathway Activity Assumptions:"), "Similarly to the Semaglutide pathway above, 
                                     this section contains the assumptions for the Lanifibranor pathway."),
                             tags$li(strong("Financial Assumptions:"), "The assumptions within this section cover the costs associated 
                                     with the delivery of each treatment. These include the costs of the treatments and associated 
                                     activities such as the cost of an appointment with a Heptalogist in secondary care or the cost of 
                                     a Liver biopsy. These assumptions are applied to the pathway activities determined in the previous 
                                     sections to determine the cost implications of each treatment pathway."),
                             tags$li(strong("Model Outputs - Activity and Costs:"), "This section contains the outputs of the model. 
                                     These outputs include the volume of patients treated, the clinical activities undertaken for these 
                                     treatment cohorts and the costs associated with these. The outputs are produced at a summary level 
                                     and also include a breakdown of the activities and costs at each stage of the pathways.")
                           )
                         ),
                        br(),
                        h3("Navigating the model"),
                        p("You can navigate through the different stages of the model using the navigation bar at the top of this page. 
                          Clicking on any of the tabs will take you to the relevant screen for inputting assumptions or viewing the 
                          outputs of the model."),
                        br(),
                        h3("Changing model assumptions"),
                        p("This model has been created to enable the ability to create bespoke scenarios for delivering these new treatments. 
                          Consequently, each of the model assumptions can be amended to simulate activities and costs under those conditions. 
                          By default each assumption within the model will be set to the specified value as determined by the modelling group. 
                          This will be based on available literature, input from clinical experts and feedback from the pathway mapping 
                          workstream. To amend any of these assumptions simply:",
                          tags$ul(
                            tags$li("Change the value of the slider input to the desired value"),
                            tags$li("Input a specific number into an input box"),
                            tags$li("Amend the table of percentages to model the setting for specific activities")
                          )),
                        p("Some of the assumptions will have data validation or limits applied to stop impossible assumptions being applied. 
                          For example, applying negative percentages.")
                         ),
               nav_panel("Explanation of Assumptions"),
               nav_panel("Modelling Documentation")
             )
           )
  ),
  
  tabPanel(title = "Population Assumptions",
           fluidPage(
             sidebarLayout(
               sidebarPanel(
                 h4("Set Adult Population:"),
                 numericInput("adult_pop",
                              "Set Adult Population:",
                              value = 10000,
                              min = 0,
                              step = 10000),
                 h4("Set the MASLD and MASH Prevalence:"),
                 sliderInput("masld_prev",
                             "Set MASLD Prevalence:",
                             value = 24,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("masld_prev_tol",
                             "Set MASLD Prevalence tolerance:",
                             value = 5,
                             min = 0,
                             max = 25,
                             step = 0.5,
                             post = "%"),
                 sliderInput("mash_prev",
                             "Set MASH Prevalence:",
                             value = 4.5,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("mash_prev_tol",
                             "Set MASH Prevalence tolerance:",
                             value = 1,
                             min = 0,
                             max = 10,
                             step = 0.25,
                             post = "%"),
                 br(),
                 h4("Set the Fibrosis Stage Assumptions"),
                 sliderInput("F0_prop",
                             "Set proportion at stage F0:",
                             value = 23,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("F1_prop",
                             "Set the proportion at stage F1:",
                             value = 36,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("F2_prop",
                             "Set the proportion at stage F2:",
                             value = 20,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("F3_prop",
                             "Set the proportion at stage F3:",
                             value = 13,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("F4_prop",
                             "Set the proportion at stage F4:",
                             value = 8,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 br(),
                 h4("Set the Prevalence rates of Obesity and Diabetes"),
                 sliderInput("ob_prev",
                             "Prevalence of obesity within MASLD population:",
                             value = 55,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("ob_prev_tol",
                             "Set the obesity prevalence tolerance:",
                             value = 10,
                             min = 0,
                             max = 20,
                             step = 1,
                             post = "%"),
                 sliderInput("t2d_prev",
                             "Prevalence of Type 2 Diabetes within MASLD population",
                             value = 30,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("t2d_prev_tol",
                             "Set the Type 2 Diabetes prevalence tolerance:",
                             value = 12,
                             min = 0,
                             max = 25,
                             step = 1,
                             post = "%"),
                 br(),
                 h4("Set the diagnosis rates for each Fibrosis Stage:"),
                 sliderInput("diag_F0",
                             "Set the diagnosis rate for F0:",
                             value = 2,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("diag_F1",
                             "Set the diagnosis rate for F1:",
                             value = 2,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("diag_F2",
                             "Set the diagnosis rate for F2:",
                             value = 16.5,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("diag_F3",
                             "Set the diagnosis rate for F3:",
                             value = 58.3,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 sliderInput("diag_F4",
                             "Set the diagnosis rate for F4:",
                             value = 100,
                             min = 0,
                             max = 100,
                             step = 1,
                             post = "%"),
                 br(),
                 h4("Download Assumptions"),
                 downloadButton("download_assumptions", "Download Population Assumptions")
               ),
               mainPanel(
                 h1("Population Assumptions"),
                 p("The section below shows the impact of each of the assumptions to the left on determining the population 
                   of patients that would be eligible for the new treatment pathways. Each section below will contain:",
                   tags$ul(
                     tags$li("A histogram showing the populations simulated from the assumptions"),
                     tags$li("A data table showing the populations for each simulation. Within each table:",
                             tags$ul(
                               tags$li("Simulation 1: The central estimate based on the assumptions"),
                               tags$li("Simulation 2: The lower bound estimate based on the lower tolerance for each assumption"),
                               tags$li("Simulation 3: The upper bound estimate based on the higher tolerance for each assumption"),
                               tags$li("Simulations 4 - 100: Simulated data based on the above lower, central and upper parameters")
                             ))
                   )),
                 h3("MASLD Prevalence"),
                 p("The tabs below show the simulated MASLD populations to be used within the model as either a histogram or table:"),
                 textOutput("masld_prev"),
                 navset_tab(
                   nav_panel("Histogram", plotOutput("masld_pop_histogram")),
                   nav_panel("Table", DTOutput("masld_pop_DT"))
                 ),
                 h3("MASH Prevalence"),
                 p("The tabs below show the simulated MASH populations to be used within the model as either a histogram or table:"),
                 navset_tab(
                   nav_panel("Histogram", plotOutput("mash_pop_histogram")),
                   nav_panel("Table", DTOutput("mash_pop_DT"))
                 ),
                 h3("Fibrosis Stage Populations"),
                 p("The tabs below show the simulated MASH populations by Fibrosis stage that will be used within the model as either a histogram or table:"),
                 navset_tab(
                   nav_panel("Histogram", plotOutput("f_stage_pop_histogram")),
                   nav_panel("Table", DTOutput("f_stage_pop_DT"))
                 ),
                 h3("Co-morbidities"),
                 p("TODO"),
                 h3("Diagnosed Population Estimates"),
                 p("The tabs below show the estimated population at each Fibrosis stage that is diagnosed. This is shown as either a histogram or a table:"),
                 navset_tab(
                   nav_panel("Histogram", plotOutput("f_stage_diag_histogram")),
                   nav_panel("Table", DTOutput("f_stage_diag_DT"))
                 ),
                 
               )
             )
           )
  ),
  
  tabPanel(title = "Treatment Implementation",
           fluidPage(
             h1("Populations receiving treatments"),
             p("In this section please specify the proportion of each group who will receive each treatment type."),
             navset_tab(
               nav_panel("Semaglutide",
                         sidebarLayout(
                           sidebarPanel(
                                h3("Semaglutide"),
                                hr(),
                                sliderInput("treat_pop_F0_sem",
                                            "Select the proportion of F0 patients receiving treatment:",
                                            value = 0,
                                            min = 0,
                                            max = 100,
                                            post = "%"),
                                sliderInput("treat_pop_F1_sem",
                                            "Select the proportion of F1 patients receiving treatment:",
                                            value = 0,
                                            min = 0,
                                            max = 100,
                                            post = "%"),
                                sliderInput("treat_pop_F2_sem",
                                            "Select the proportion of F2 patients receiving treatment:",
                                            value = 40,
                                            min = 0,
                                            max = 100,
                                            post = "%"),
                                sliderInput("treat_pop_F3_sem",
                                            "Select the proportion of F3 patients receiving treatment:",
                                            value = 85,
                                            min = 0,
                                            max = 100,
                                            post = "%"),
                                sliderInput("treat_pop_F4_sem",
                                            "Select the proportion of F4 patients receiving treatment:",
                                            value = 0,
                                            min = 0,
                                            max = 100,
                                            post = "%")
                                ),
                           mainPanel(
                                h4("Table of treatment population"),
                                DTOutput("treat_pop_sem_DT")
                           )
                         )
               ),
               nav_panel("Survodutide",
                         sidebarLayout(
                           sidebarPanel(
                             h3("Survodutide"),
                             hr(),
                             sliderInput("treat_pop_F0_surv",
                                         "Select the proportion of F0 patients receiving treatment:",
                                         value = 0,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F1_surv",
                                         "Select the proportion of F1 patients receiving treatment:",
                                         value = 0,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F2_surv",
                                         "Select the proportion of F2 patients receiving treatment:",
                                         value = 5,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F3_surv",
                                         "Select the proportion of F3 patients receiving treatment:",
                                         value = 5,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F4_surv",
                                         "Select the proportion of F4 patients receiving treatment:",
                                         value = 0,
                                         min = 0,
                                         max = 100,
                                         post = "%")
                           ),
                           mainPanel(
                             h4("Table of treatment population"),
                             DTOutput("treat_pop_surv_DT")
                           )
                         )
               ),
               nav_panel("Resmetirom",
                         sidebarLayout(
                           sidebarPanel(
                             h3("Resmetirom"),
                             hr(),
                             sliderInput("treat_pop_F0_res",
                                         "Select the proportion of F0 patients receiving treatment:",
                                         value = 0,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F1_res",
                                         "Select the proportion of F1 patients receiving treatment:",
                                         value = 0,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F2_res",
                                         "Select the proportion of F2 patients receiving treatment:",
                                         value = 5,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F3_res",
                                         "Select the proportion of F3 patients receiving treatment:",
                                         value = 5,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F4_res",
                                         "Select the proportion of F4 patients receiving treatment:",
                                         value = 0,
                                         min = 0,
                                         max = 100,
                                         post = "%")
                           ),
                           mainPanel(
                             h4("Table of treatment population"),
                             DTOutput("treat_pop_res_DT")
                           )
                         )
               ),
               nav_panel("Lanifibranor",
                         sidebarLayout(
                           sidebarPanel(
                             h3("Lanifibranor"),
                             hr(),
                             sliderInput("treat_pop_F0_lan",
                                         "Select the proportion of F0 patients receiving treatment:",
                                         value = 0,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F1_lan",
                                         "Select the proportion of F1 patients receiving treatment:",
                                         value = 0,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F2_lan",
                                         "Select the proportion of F2 patients receiving treatment:",
                                         value = 5,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F3_lan",
                                         "Select the proportion of F3 patients receiving treatment:",
                                         value = 5,
                                         min = 0,
                                         max = 100,
                                         post = "%"),
                             sliderInput("treat_pop_F4_lan",
                                         "Select the proportion of F4 patients receiving treatment:",
                                         value = 0,
                                         min = 0,
                                         max = 100,
                                         post = "%")
                           ),
                           mainPanel(
                             h4("Table of treatment population"),
                             DTOutput("treat_pop_lan_DT")
                           )
                         )
               )
                         
             )
           )
  ),
  tabPanel(title = "Semaglutide Pathway Activity Assumptions",
           fluidPage(
             h1("Semaglutide Pathway Activity Assumptions"),
             p("In this section you can set the assumptions about the clinical activities that occur along the treatment pathway.
               These assumptions will then be applied in conjunction with the number starting this treatment and financial assumptions 
               to generate the associated activities and costs. Please refer to the ", strong("Pathway Map"), " tab to review the 
               pathway."),
             navset_tab(
               nav_panel("Pathway Assumptions",
                 fluidRow(
                   column(2,
                          h3("Pre-Treatment"),
                          hr(),
                          h4("Diagnostics"),
                          sliderInput("pre_liver_biopsy_prop_sem",
                                      "Set percentage undergoing biopsy:",
                                      value = 10,
                                      min = 0,
                                      max = 100,
                                      post= "%"),
                          sliderInput("pre_elf_prop_sem",
                                      "Set percentage undergoing ELF testing:",
                                      value = 85,
                                      min = 0,
                                      max = 100,
                                      post= "%"),
                          sliderInput("pre_biomarkers_prop_sem",
                                      "Set percentage undergoing other biomarker testing:",
                                      value = 50,
                                      min = 0,
                                      max = 100,
                                      post= "%"),
                          sliderInput("pre_fibro_prop_sem",
                                      "Set percentage undergoing Fibroscan:",
                                      value = 65,
                                      min = 0,
                                      max = 100,
                                      post= "%"),
                          hr(),
                          h4("Multi-morbidity patient assessment"),
                          sliderInput("mm_assess_prop_sem",
                                      "Set percentage undergoing multimorbidity assessment:",
                                      value = 100,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          matrixInput("mm_assess_setting_sem",
                                      "Input setting for multimorbidity assessment:",
                                      value = matrix(c(10,
                                                       5,
                                                       75,
                                                       10,
                                                       0,
                                                       0),
                                                     ncol = 1,
                                                     byrow = TRUE,
                                                     dimnames = list(c("Primary Care - GP",
                                                                       "Primary Care - Nurse Led",
                                                                       "Secondary Care - Hepatology/Gastro Consultant",
                                                                       "Secondary Care - Hepatology/Gastro CNS",
                                                                       "Community - Diagnostician",
                                                                       "Community - Pharmacist"),
                                                                     c("Percentage (%)")
                                                     )),
                                      class = "numeric",
                          )
                          
                   ),
                   column(2,
                          h3("Week 0: Treatment Delivery"),
                          hr(),
                          h4("Treatment Retention"),
                          sliderInput("retention_sem_0_16",
                                      "Input retention on Semaglutide for 16 weeks:",
                                      value = 85,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          hr(),
                          h4("Treatment Setting"),
                          matrixInput("treatment_setting_0_16_matrix_sem",
                                      "Input setting for delivery of initial treatment:",
                                      value = matrix(c(10,
                                                       5,
                                                       75,
                                                       10,
                                                       0,
                                                       0),
                                                     ncol = 1,
                                                     byrow = TRUE,
                                                     dimnames = list(c("Primary Care - GP",
                                                                       "Primary Care - Nurse Led",
                                                                       "Secondary Care - Hepatology/Gastro Consultant",
                                                                       "Secondary Care - Hepatology/Gastro CNS",
                                                                       "Community - Diagnostician",
                                                                       "Community - Pharmacist"),
                                                                     c("Percentage (%)")
                                                     )),
                                      class = "numeric",
                          )
                          
                   ),
                   column(2,
                          h3("Weeks 4-71: Monitoring and Dosage Maintenance"),
                          hr(),
                          h4("Monitoring Tests"),
                          numericInput("monitoring_tests_number_sem",
                                       "Select number of monitoring tests:",
                                       value = 9,
                                       min = 0,
                                       max = NA,
                                       step = 1),
                          sliderInput("monitoring_elf_prop_sem",
                                      "Select percentage of monitoring tests that are ELF:",
                                      value = 75,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          sliderInput("monitoring_bio_prop_sem",
                                      "Select percentage of monitoring tests that are biomarkers:",
                                      value = 25,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          hr(),
                          h4("Dosage Maintenence"),
                          sliderInput("dosage_retention_20_71_sem",
                                      "Select the retention rate of those at Dosage Maintenance:",
                                      value = 90,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          matrixInput("semaglutide_20_71_delivery_setting",
                                      "Input setting for delivery of treatment for weeks 20-71:",
                                      value = matrix(c(10,
                                                       5,
                                                       75,
                                                       10,
                                                       0,
                                                       0),
                                                     ncol = 1,
                                                     byrow = TRUE,
                                                     dimnames = list(c("Primary Care - GP",
                                                                       "Primary Care - Nurse Led",
                                                                       "Secondary Care - Hepatology/Gastro Consultant",
                                                                       "Secondary Care - Hepatology/Gastro CNS",
                                                                       "Community - Diagnostician",
                                                                       "Community - Pharmacist"),
                                                                     c("Percentage (%)")
                                                     )),
                                      class = "numeric",
                          )
                   ),
                   column(2,
                          h3("Week 72: Continuation"),
                          hr(),
                          h4("Efficacy Assessment"),
                          sliderInput("efficacy_liver_biopsy_prop_sem",
                                      "Select the percentage of patients undergoing a liver biopsy:",
                                      value = 60,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          sliderInput("efficacy_elf_prop_sem",
                                      "Select the percentage of patients undergoing ELF testing:",
                                      value = 70,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          sliderInput("efficacy_biomarkers_prop_sem",
                                      "Select the percentage of patients undergoing biomarker testing:",
                                      value = 30,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          hr(),
                          h4("Continuation Decision"),
                          sliderInput("continuation_prop_sem",
                                      "Select the percentage of patients continuing with treatment:",
                                      value = 60,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          matrixInput("continuation_delivery_setting_sem",
                                      "Input the setting for continuation decision appointment:",
                                      value = matrix(c(10,
                                                       5,
                                                       75,
                                                       10,
                                                       0,
                                                       0),
                                                     ncol = 1,
                                                     byrow = TRUE,
                                                     dimnames = list(c("Primary Care - GP",
                                                                       "Primary Care - Nurse Led",
                                                                       "Secondary Care - Hepatology/Gastro Consultant",
                                                                       "Secondary Care - Hepatology/Gastro CNS",
                                                                       "Community - Diagnostician",
                                                                       "Community - Pharmacist"),
                                                                     c("Percentage (%)")
                                                     )),
                                      class = "numeric",
                          )
                          
                   ),
                   column(2,
                          h3("Week 73-103: Dosage Maintenance"),
                          hr(),
                          h4("Retention Rate"),
                          sliderInput("retention_73_103_sem",
                                      "Select the retention rate for patients receiving dosage maintenance:",
                                      value = 90,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          matrixInput("semaglutide_73_103_delivery_setting",
                                      "Input the setting for delivery of Semaglutide for weeks 73-103:",
                                      value = matrix(c(10,
                                                       5,
                                                       75,
                                                       10,
                                                       0,
                                                       0),
                                                     ncol = 1,
                                                     byrow = TRUE,
                                                     dimnames = list(c("Primary Care - GP",
                                                                       "Primary Care - Nurse Led",
                                                                       "Secondary Care - Hepatology/Gastro Consultant",
                                                                       "Secondary Care - Hepatology/Gastro CNS",
                                                                       "Community - Diagnostician",
                                                                       "Community - Pharmacist"),
                                                                     c("Percentage (%)")
                                                     )),
                                      class = "numeric",
                          ),
                          hr(),
                          h4("Monitoring Testing"),
                          numericInput("monitoring_tests_number_73_103_sem",
                                       "Select number of monitoring tests:",
                                       value = 3,
                                       min = 0,
                                       max = NA,
                                       step = 1),
                          sliderInput("monitoring_tests_73_103_elf_sem",
                                      "Select the percentage of patients undergoing ELF testing:",
                                      value = 75,
                                      min = 0,
                                      max = 100,
                                      post = "%")
                   ),
                   column(2,
                          h3("Week 104+: Ongoing Treatment"),
                          hr(),
                          h4("Treatment Weeks to Model"),
                          numericInput("ongoing_period_sem",
                                       "Select the number of weeks to continue modelling treatment",
                                       value = 104,
                                       min = 52,
                                       max = 208,
                                       step = 1),
                          hr(),
                          h4("Retention by End-point"),
                          sliderInput("retention_end_sem",
                                      "Select the retention rate by the end-point of the model:",
                                      value = 75,
                                      min = 0,
                                      max = 100,
                                      post = "%"),
                          hr(),
                          h4("Ongoing Treatment Setting"),
                          matrixInput("semaglutide_ongoing_delivery_setting",
                                      "Input the setting for delivery of Semaglutide until end-point:",
                                      value = matrix(c(10,
                                                       5,
                                                       75,
                                                       10,
                                                       0,
                                                       0),
                                                     ncol = 1,
                                                     byrow = TRUE,
                                                     dimnames = list(c("Primary Care - GP",
                                                                       "Primary Care - Nurse Led",
                                                                       "Secondary Care - Hepatology/Gastro Consultant",
                                                                       "Secondary Care - Hepatology/Gastro CNS",
                                                                       "Community - Diagnostician",
                                                                       "Community - Pharmacist"),
                                                                     c("Percentage (%)")
                                                     )),
                                      class = "numeric",
                          )
                   )
                 )
               ),
               nav_panel("Pathway Map",
                         includeHTML("www/images/DRAFT MASLD Treatment Formatted v0.6 for AB.drawio.html")
             )
            )
           )
  ),
  tabPanel(title = "Survodutide Pathway Activity Assumptions",
           fluidPage(
             h1("Survodutide Pathway Activity Assumptions"),
             p("In this section you can set the assumptions about the clinical activities that occur along the treatment pathway.
               These assumptions will then be applied in conjunction with the number starting this treatment and financial assumptions 
               to generate the associated activities and costs. Please refer to the ", strong("Pathway Map"), " tab to review the 
               pathway."),
             navset_tab(
               nav_panel("Pathway Assumptions",
                         fluidRow(
                           column(2,
                                  h3("Pre-Treatment"),
                                  hr(),
                                  h4("Diagnostics"),
                                  sliderInput("pre_liver_biopsy_prop_surv",
                                              "Set percentage undergoing biopsy:",
                                              value = 10,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  sliderInput("pre_elf_prop_surv",
                                              "Set percentage undergoing ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  sliderInput("pre_biomarkers_prop_surv",
                                              "Set percentage undergoing other biomarker testing:",
                                              value = 50,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  sliderInput("pre_fibro_prop_surv",
                                              "Set percentage undergoing Fibroscan:",
                                              value = 65,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  hr(),
                                  h4("Multi-morbidity patient assessment"),
                                  sliderInput("mm_assess_prop_surv",
                                              "Set percentage undergoing multimorbidity assessment:",
                                              value = 100,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  matrixInput("mm_assess_setting_surv",
                                              "Input setting for multimorbidity assessment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                           ),
                           column(2,
                                  h3("Week 0: Treatment Delivery"),
                                  hr(),
                                  h4("Treatment Retention"),
                                  sliderInput("retention_surv_0_24",
                                              "Set the retention rate for weeks 0 - 24:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Treatment Setting"),
                                  matrixInput("treatment_setting_0_24_matrix_surv",
                                              "Input setting for delivery of initial treatment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                                  
                           ),
                           column(2,
                                  h3("Weeks 0-71: Monitoring and Dosage Maintenance"),
                                  hr(),
                                  h4("Monitoring Tests"),
                                  numericInput("monitor_tests_0_71_num_surv",
                                               "Set the number of monitoring tests:",
                                               value = 3,
                                               min = 0,
                                               max = NA,
                                               step = 1),
                                  sliderInput("monitor_tests_0_71_elf_prop_surv",
                                              "Set the percentage receiving an ELF test:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("monitor_tests_0_71_bio_prop_surv",
                                              "Set the percentage receiving other biomarker tests:",
                                              value = 75,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Treatment Weeks 25 - 71"),
                                  sliderInput("retention_25_71_surv",
                                              "Set the retention rate for weeks 25 - 71:",
                                              value = 95,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  matrixInput("treatment_setting_25_71_matrix_surv",
                                              "Input setting for delivery of treatment for weeks 25 - 71:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                                  ),
                           column(2,
                                  h3("Week 72: Continuation Decision"),
                                  hr(),
                                  h4("Efficacy Assessment"),
                                  sliderInput("efficacy_liver_biopsy_surv",
                                              "Set the percentage of paitents undergoing a liver biopsy:",
                                              value = 25,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("efficacy_elf_prop_surv",
                                              "Set the percentage of patients undergoing ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("efficacy_fibro_prop_surv",
                                              "Set the percentage of patients undergoing a Fibroscan:",
                                              value = 35,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("efficacy_biomarkers_prop_surv",
                                              "Set the percentage of patients undergoing other Biomarkers:",
                                              value = 65,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Continuation Decision"),
                                  sliderInput("continuation_prop_surv",
                                              "Select the percentage of patients continuing with treatment:",
                                              value = 60,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  matrixInput("continuation_delivery_setting_surv",
                                              "Input setting for appointment of conitnuation decision:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                                  ),
                           column(2,
                                  h3("Week 73-103: Dosage Maintenance"),
                                  hr(),
                                  h4("Retention Rate"),
                                  sliderInput("retention_73_103_surv",
                                              "Select the retention rate for patients receiving dosage maintenance:",
                                              value = 90,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Treatment Setting"),
                                  matrixInput("treatment_setting_73_103_matrix_surv",
                                              "Input setting for delivery of treatment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  ),
                                  hr(),
                                  h4("Monitoring Testing"),
                                  numericInput("monitoring_tests_number_73_103_surv",
                                               "Select number of monitoring tests:",
                                               value = 2,
                                               min = 0,
                                               max = NA,
                                               step = 1),
                                  sliderInput("monitoring_tests_73_103_elf_surv",
                                              "Select the percentage of patients undergoing ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("monitoring_tests_73_103_biomarkers_surv",
                                              "Select the percentage of patients undergoing Biomarker testing:",
                                              value = 60,
                                              min = 0,
                                              max = 100,
                                              post = "%")
                           ),
                           column(2,
                                  h3("Week 104+: Ongoing Treatment"),
                                  hr(),
                                  h4("Treatment Weeks to Model"),
                                  numericInput("ongoing_period_surv",
                                               "Select the number of weeks to continue modelling treatment",
                                               value = 104,
                                               min = 52,
                                               max = 208,
                                               step = 1),
                                  hr(),
                                  h4("Retention by End-point"),
                                  sliderInput("retention_end_surv",
                                              "Select the retention rate by the end-point of the model:",
                                              value = 75,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Ongoing Treatment Setting"),
                                  matrixInput("survodutide_ongoing_delivery_setting",
                                              "Input setting for delivery of treatment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  ),
                                  hr(),
                                  h4("Annual Assessment"),
                                  sliderInput("ongoing_annual_prop_elf_surv",
                                              "Set the proportion of annual assessments requiring ELF test:",
                                              value = 90,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("ongoing_annual_prop_biomarkers_surv",
                                              "Set the proportion of annual assessments requiring other biomarkers:",
                                              value = 65,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("ongoing_annual_prop_fibro_surv",
                                              "Set the proportion of annual assessments requiring Fibroscan:",
                                              value = 25,
                                              min = 0,
                                              max = 100,
                                              post = "%")
                           )
                         )
                         ),
               nav_panel("Pathway Map",
                         includeHTML("www/images/DRAFT MASLD Treatment Formatted v0.6 for AB.drawio.html")
               )
             )
           )
  ),
  tabPanel(title = "Resmetirom Pathway Activity Assumptions",
           fluidPage(
             h1("Resmetirom Pathway Activity Assumptions"),
             p("In this section you can set the assumptions about the clinical activities that occur along the treatment pathway.
               These assumptions will then be applied in conjunction with the number starting this treatment and financial assumptions 
               to generate the associated activities and costs. Please refer to the ", strong("Pathway Map"), " tab to review the 
               pathway."),
             navset_tab(
               nav_panel("Pathway Assumptions",
                         fluidRow(
                           column(2,
                                  h3("Pre-Treatment"),
                                  hr(),
                                  h4("Diagnostics"),
                                  sliderInput("pre_liver_biopsy_prop_res",
                                              "Set percentage undergoing biopsy:",
                                              value = 10,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  sliderInput("pre_elf_prop_res",
                                              "Set percentage undergoing ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  sliderInput("pre_biomarkers_prop_res",
                                              "Set percentage undergoing other biomarker testing:",
                                              value = 50,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  sliderInput("pre_fibro_prop_res",
                                              "Set percentage undergoing Fibroscan:",
                                              value = 65,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  hr(),
                                  h4("Multi-morbidity patient assessment"),
                                  sliderInput("mm_assess_prop_res",
                                              "Set percentage undergoing multimorbidity assessment:",
                                              value = 100,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  matrixInput("mm_assess_setting_res",
                                              "Input setting for multimorbidity assessment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                           ),
                           column(2,
                                  h3("Weeks 0 - 71: Initial Treatment"),
                                  hr(),
                                  h4("Dosage"),
                                  sliderInput("dosage_0_71_res",
                                              "Set proportion of those starting treatment under 100kg:",
                                              value = 80,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Treatment Retention"),
                                  sliderInput("retention_res_0_71",
                                              "Set the retention rate for weeks 0 - 71:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Treatment Setting"),
                                  matrixInput("treatment_setting_0_71_matrix_res",
                                              "Input setting for delivery of initial treatment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                           ),
                           column(2,
                                  h3("Weeks 0-71: Monitoring"),
                                  hr(),
                                  h4("Monitoring"),
                                  numericInput("monitor_tests_0_71_res",
                                               "Set the number of monitoring tests:",
                                               value = 2,
                                               min = 0,
                                               max = NA,
                                               step = 1),
                                  sliderInput("monitor_tests_0_71_elf_res",
                                              "Set the proportion of monitoring tests including ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("monitor_tests_0_71_biomarkers_res",
                                              "Set the proportion of monitoring tests including other biomarkers:",
                                              value = 45,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("monitor_tests_0_71_fibro_res",
                                              "Se the proportion of monitoring tests including a Fibroscan:",
                                              value = 35,
                                              min = 0,
                                              max = 100,
                                              post = "%")
                           ),
                           column(2,
                                  h3("Week 72: Continuation Decision"),
                                  hr(),
                                  h4("Efficacy Assessment"),
                                  sliderInput("efficacy_liver_biopsy_res",
                                              "Set the percentage of paitents undergoing a liver biopsy:",
                                              value = 25,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("efficacy_elf_prop_res",
                                              "Set the percentage of patients undergoing ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("efficacy_fibro_prop_res",
                                              "Set the percentage of patients undergoing a Fibroscan:",
                                              value = 35,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("efficacy_biomarkers_prop_res",
                                              "Set the percentage of patients undergoing other Biomarkers:",
                                              value = 65,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Continuation Decision"),
                                  sliderInput("continuation_prop_res",
                                              "Select the percentage of patients continuing with treatment:",
                                              value = 60,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  matrixInput("continuation_delivery_setting_res",
                                              "Input setting for appointment of conitnuation decision:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                                  ),
                           column(2,
                                  h3("Week 73-103: Dosage Maintenance"),
                                  hr(),
                                  h4("Retention Rate"),
                                  sliderInput("retention_73_103_res",
                                              "Select the retention rate for patients receiving dosage maintenance:",
                                              value = 90,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Treatment Setting"),
                                  matrixInput("treatment_setting_73_103_matrix_res",
                                              "Input setting for delivery of treatment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  ),
                                  hr(),
                                  h4("Monitoring Testing"),
                                  numericInput("monitoring_tests_number_73_103_res",
                                               "Select number of monitoring tests:",
                                               value = 2,
                                               min = 0,
                                               max = NA,
                                               step = 1),
                                  sliderInput("monitoring_tests_73_103_elf_res",
                                              "Select the percentage of patients undergoing ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("monitoring_tests_73_103_biomarkers_res",
                                              "Select the percentage of patients undergoing Biomarker testing:",
                                              value = 60,
                                              min = 0,
                                              max = 100,
                                              post = "%")
                           ),
                           column(2,
                                  h3("Week 104+: Ongoing Treatment"),
                                  hr(),
                                  h4("Treatment Weeks to Model"),
                                  numericInput("ongoing_period_res",
                                               "Select the number of weeks to continue modelling treatment",
                                               value = 104,
                                               min = 52,
                                               max = 208,
                                               step = 1),
                                  hr(),
                                  h4("Retention by End-point"),
                                  sliderInput("retention_end_res",
                                              "Select the retention rate by the end-point of the model:",
                                              value = 75,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Ongoing Treatment Setting"),
                                  matrixInput("resmetirom_ongoing_delivery_setting",
                                              "Input setting for delivery of treatment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  ),
                                  hr(),
                                  h4("Annual Assessment"),
                                  sliderInput("ongoing_annual_prop_elf_res",
                                              "Set the proportion of annual assessments requiring ELF test:",
                                              value = 90,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("ongoing_annual_prop_biomarkers_res",
                                              "Set the proportion of annual assessments requiring other biomarkers:",
                                              value = 65,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("ongoing_annual_prop_fibro_res",
                                              "Set the proportion of annual assessments requiring Fibroscan:",
                                              value = 25,
                                              min = 0,
                                              max = 100,
                                              post = "%")
                           )
                         )
               ),
               nav_panel("Pathway Map",
                         includeHTML("www/images/DRAFT MASLD Treatment Formatted v0.6 for AB.drawio.html")
               )
             )
           )
  ),
  tabPanel(title = "Lanifibranor Pathway Activity Assumptions",
           fluidPage(
             h1("Lanifibranor Pathway Activity Assumptions"),
             p("In this section you can set the assumptions about the clinical activities that occur along the treatment pathway.
               These assumptions will then be applied in conjunction with the number starting this treatment and financial assumptions 
               to generate the associated activities and costs. Please refer to the ", strong("Pathway Map"), " tab to review the 
               pathway."),
             navset_tab(
               nav_panel("Pathway Assumptions",
                         fluidRow(
                           column(2,
                                  h3("Pre-Treatment"),
                                  hr(),
                                  h4("Diagnostics"),
                                  sliderInput("pre_liver_biopsy_prop_lan",
                                              "Set percentage undergoing biopsy:",
                                              value = 10,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  sliderInput("pre_elf_prop_lan",
                                              "Set percentage undergoing ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  sliderInput("pre_biomarkers_prop_lan",
                                              "Set percentage undergoing other biomarker testing:",
                                              value = 50,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  sliderInput("pre_fibro_prop_lan",
                                              "Set percentage undergoing Fibroscan:",
                                              value = 65,
                                              min = 0,
                                              max = 100,
                                              post= "%"),
                                  hr(),
                                  h4("Multi-morbidity patient assessment"),
                                  sliderInput("mm_assess_prop_lan",
                                              "Set percentage undergoing multimorbidity assessment:",
                                              value = 100,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  matrixInput("mm_assess_setting_lan",
                                              "Input setting for multimorbidity assessment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                           ),
                           column(2,
                                  h3("Weeks 0 - 71: Initial Treatment"),
                                  hr(),
                                  h4("Dosage"),
                                  sliderInput("dosage_0_71_lan",
                                              "Set proportion of those starting treatment at 800mg:",
                                              value = 80,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Treatment Retention"),
                                  sliderInput("retention_lan_0_71",
                                              "Set the retention rate for weeks 0 - 71:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Treatment Setting"),
                                  matrixInput("treatment_setting_0_71_matrix_lan",
                                              "Input setting for delivery of initial treatment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                           ),
                           column(2,
                                  h3("Weeks 0-71: Monitoring"),
                                  hr(),
                                  h4("Monitoring"),
                                  numericInput("monitor_tests_0_71_lan",
                                               "Set the number of monitoring tests:",
                                               value = 2,
                                               min = 0,
                                               max = NA,
                                               step = 1),
                                  sliderInput("monitor_tests_0_71_elf_lan",
                                              "Set the proportion of monitoring tests including ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("monitor_tests_0_71_biomarkers_lan",
                                              "Set the proportion of monitoring tests including other biomarkers:",
                                              value = 45,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("monitor_tests_0_71_fibro_lan",
                                              "Se the proportion of monitoring tests including a Fibroscan:",
                                              value = 35,
                                              min = 0,
                                              max = 100,
                                              post = "%")
                           ),
                           column(2,
                                  h3("Week 72: Continuation Decision"),
                                  hr(),
                                  h4("Efficacy Assessment"),
                                  sliderInput("efficacy_liver_biopsy_lan",
                                              "Set the percentage of paitents undergoing a liver biopsy:",
                                              value = 25,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("efficacy_elf_prop_lan",
                                              "Set the percentage of patients undergoing ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("efficacy_fibro_prop_lan",
                                              "Set the percentage of patients undergoing a Fibroscan:",
                                              value = 35,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("efficacy_biomarkers_prop_lan",
                                              "Set the percentage of patients undergoing other Biomarkers:",
                                              value = 65,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Continuation Decision"),
                                  sliderInput("continuation_prop_lan",
                                              "Select the percentage of patients continuing with treatment:",
                                              value = 60,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  matrixInput("continuation_delivery_setting_lan",
                                              "Input setting for appointment of conitnuation decision:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  )
                           ),
                           column(2,
                                  h3("Week 73-103: Dosage Maintenance"),
                                  hr(),
                                  h4("Retention Rate"),
                                  sliderInput("retention_73_103_lan",
                                              "Select the retention rate for patients receiving dosage maintenance:",
                                              value = 90,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Treatment Setting"),
                                  matrixInput("treatment_setting_73_103_matrix_lan",
                                              "Input setting for delivery of treatment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  ),
                                  hr(),
                                  h4("Monitoring Testing"),
                                  numericInput("monitoring_tests_number_73_103_lan",
                                               "Select number of monitoring tests:",
                                               value = 2,
                                               min = 0,
                                               max = NA,
                                               step = 1),
                                  sliderInput("monitoring_tests_73_103_elf_lan",
                                              "Select the percentage of patients undergoing ELF testing:",
                                              value = 85,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("monitoring_tests_73_103_biomarkers_lan",
                                              "Select the percentage of patients undergoing Biomarker testing:",
                                              value = 60,
                                              min = 0,
                                              max = 100,
                                              post = "%")
                           ),
                           column(2,
                                  h3("Week 104+: Ongoing Treatment"),
                                  hr(),
                                  h4("Treatment Weeks to Model"),
                                  numericInput("ongoing_period_lan",
                                               "Select the number of weeks to continue modelling treatment",
                                               value = 104,
                                               min = 52,
                                               max = 208,
                                               step = 1),
                                  hr(),
                                  h4("Retention by End-point"),
                                  sliderInput("retention_end_lan",
                                              "Select the retention rate by the end-point of the model:",
                                              value = 75,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  hr(),
                                  h4("Ongoing Treatment Setting"),
                                  matrixInput("lan_ongoing_delivery_setting",
                                              "Input setting for delivery of treatment:",
                                              value = matrix(c(10,
                                                               5,
                                                               75,
                                                               10,
                                                               0,
                                                               0),
                                                             ncol = 1,
                                                             byrow = TRUE,
                                                             dimnames = list(c("Primary Care - GP",
                                                                               "Primary Care - Nurse Led",
                                                                               "Secondary Care - Hepatology/Gastro Consultant",
                                                                               "Secondary Care - Hepatology/Gastro CNS",
                                                                               "Community - Diagnostician",
                                                                               "Community - Pharmacist"),
                                                                             c("Percentage (%)")
                                                             )),
                                              class = "numeric",
                                  ),
                                  hr(),
                                  h4("Annual Assessment"),
                                  sliderInput("ongoing_annual_prop_elf_lan",
                                              "Set the proportion of annual assessments requiring ELF test:",
                                              value = 90,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("ongoing_annual_prop_biomarkers_lan",
                                              "Set the proportion of annual assessments requiring other biomarkers:",
                                              value = 65,
                                              min = 0,
                                              max = 100,
                                              post = "%"),
                                  sliderInput("ongoing_annual_prop_fibro_lan",
                                              "Set the proportion of annual assessments requiring Fibroscan:",
                                              value = 25,
                                              min = 0,
                                              max = 100,
                                              post = "%")
                           )
                         )
               ),
               nav_panel("Pathway Map",
                         includeHTML("www/images/DRAFT MASLD Treatment Formatted v0.6 for AB.drawio.html")
               )
             )
           )
  ),
  tabPanel(title = "Financial Assumptions",
           fluidPage(
             h1("Financial Assumptions"),
             p("This section contains the assumptions covering the costs of treatments and associated 
               clinical activities. These can be amended in each of the sections below:"),
             navset_tab(
               nav_panel("Diagnostic investigation costs"
               ),
               nav_panel("Appointment costs"
               ),
               nav_panel("Drug costs"
               )
             )
           )
  ),
  tabPanel(title = "Model Outputs - Activity and Costs",
           fluidPage(
           h1("Model Outputs"),
           p("Some explanatory notes"),
           h3("Patients Receiving Treatment"),
           navset_tab(
             nav_panel("Semaglutide"
             ),
             nav_panel("Survodutide"
             ),
             nav_panel("Resmetirom"
             ),
             nav_panel("Lanifibranor"
             ),
             nav_panel("All Treamtents"
             )
           ),
           br(),
           h3("Pre-Treatment"),
           h4("Liver Biopsies"),
           p("Some text on Liver Biopsies"),
           navset_tab(
             nav_panel("Semaglutide",
                       navset_tab(
                         nav_panel("Summary"),
                         nav_panel("Data Table", DTOutput("pre_treat_biopsy_sem_DT"))
                       )
             ),
             nav_panel("Survodutide"
             ),
             nav_panel("Resmetirom"
             ),
             nav_panel("Lanifibranor"
             ),
             nav_panel("All Treamtents"
             )
           ),
           br(),
           
           )
  )
)